/* ============================================================
   ARZANKIA — Jauge d’énergie + Sac magique + Styles Monde
   ============================================================ */

/* -------------------------
   Variables globales
------------------------- */
:root {
  --bar-h: 16px;
  --bar-bg: rgba(255, 255, 255, 0.15);
  --bar-fill: linear-gradient(90deg, #ffd674, #ffe9a8);
  --bar-border: rgba(255, 214, 116, 0.6);
  --text: #fff8e6;
  --glass: rgba(10, 0, 20, 0.45);
  --overlay: rgba(0, 0, 0, 0.7);
  --hud-top: 84px;
  --bag-right: 12px;   /* marge du sac au bord droit */
  --bag-size: 48px;    /* largeur/hauteur de l'icône du sac */
  --hud-gap: 12px;     /* espace entre jauge et sac */
}

/* -------------------------
   BASE DES PAGES MONDE
------------------------- */
body {
  margin: 0;
  padding: 0;
  background: url('../images/fonds/fond_etoile_perso.webp') center top no-repeat;
  background-size: cover;
  background-color: #001d26;
  font-family: Georgia, serif;
  color: #fff8e6;
  text-shadow: 1px 1px 4px #000;
}

.container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 1.2rem 1rem 6rem;
}

.page-title {
  text-align: center;
  font-size: clamp(1.6rem, 3.5vw, 2.4rem);
  font-weight: 700;
  margin: 1.5rem auto;
  color: #ffe79a;
  text-shadow: 0 0 8px rgba(0, 0, 0, .75), 0 0 18px rgba(255, 231, 154, .25);
}

/* === Image + Ingrédient caché === */
.image-zone {
  position: relative;
  display: block;
  width: fit-content;
  margin: 0 auto 1.2rem;
}

.Fees-image {
  display: block;
  width: 100%;
  max-width: 950px;
  height: auto;
  border-radius: 18px;
  box-shadow: 0 0 25px rgba(255, 255, 255, .15);
}

/* Bouton ingrédient */
.ing-btn {
  position: absolute;
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  transform: translate(-50%, -50%);
}
.ingredient-img {
  width: 58px;
  height: auto;
  display: block;
  opacity: 0.9;
  transition: transform 0.3s ease, opacity 0.3s ease;
}

/* === Texte explicatif === */
.texte-monde {
  max-width: 800px;
  margin: 1.2rem auto;
  padding: 1rem 1.2rem;
  font-size: clamp(1rem, 1.4vw, 1.2rem);
  line-height: 1.6;
  text-align: center;
  color: #ffe79a;
  background: rgba(0, 0, 0, 0.45);
  border-radius: 12px;
  box-shadow: 0 0 12px rgba(0, 0, 0, .5);
}

/* === Boutons navigation === */
.button-group {
  display: flex;
  justify-content: center;
  gap: 1.2rem;
  margin-top: 1.5rem;
  flex-wrap: wrap;
}
.button-group a {
  display: inline-block;
  padding: .7rem 1.5rem;
  min-width: 180px;
  text-align: center;
  background: linear-gradient(145deg, #ffe9af, #f2c94c);
  color: #4a2e00;
  text-decoration: none;
  font-weight: 700;
  font-size: 1rem;
  border-radius: 30px;
  box-shadow: 0 0 10px rgba(255, 223, 100, .6);
  transition: transform .2s ease, box-shadow .2s ease;
}
.button-group a:hover {
  transform: scale(1.05);
  box-shadow: 0 0 18px rgba(255, 223, 100, 1);
}

/* ============================================================
   JAUGE D’ÉNERGIE
============================================================ */
.energy-wrap {
  position: fixed;
  top: 84px;  /* avant : 68px */
  right: 12px;
  z-index: 4000;
  display: flex;
  align-items: center;
  gap: .6rem;
  background: var(--glass);
  border: 1px solid var(--bar-border);
  padding: .6rem .75rem;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, .35);
  backdrop-filter: blur(6px);
  animation: appear 1.5s ease;
}
@keyframes appear {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}
.energy-icon { font-size: 22px; filter: drop-shadow(0 0 6px rgba(255,214,116,.7)); }
.energy-label { font-family:"Cinzel Decorative",serif; font-variant: small-caps; letter-spacing:.5px; opacity:.9; }

.energy-bar {
  width: 100px;  /* ← réduite */
  height: var(--bar-h);
  background: var(--bar-bg);
  border-radius: 999px;
  position: relative;
  overflow: hidden;
  border: 1px solid var(--bar-border);
}

@media (max-width: 768px) {
  .energy-bar { width: 60px; }  /* ← réduite sur mobile */
}

.energy-fill {
  position: absolute;
  left: 0; top: 0; bottom: 0;
  width: 0%;
  background: var(--bar-fill);
  box-shadow: inset 0 0 12px rgba(255,214,116,.55);
  transition: width .45s cubic-bezier(.22,.61,.36,1);
}
.energy-pct { min-width: 3ch; text-align: right; font-size: .9rem; opacity: .85; }

/* Ruban d’alerte (≤15%) */
.quest-ribbon {
  position: fixed;
  top: 72px; left: 50%;
  transform: translateX(-50%);
  z-index: 4600;
  background: rgba(10,0,20,.75);
  color: #fff8e6;
  border: 1px solid rgba(255,214,116,.55);
  border-radius: 10px;
  padding: .5rem .9rem;
  box-shadow: 0 10px 24px rgba(0,0,0,.45);
  backdrop-filter: blur(6px);
  font-weight: 700;
}

/* Effet de brillance pour le mode Voyageur expérimenté */
.arz-mode-experimente .energy-fill::after {
  content: "";
  position: absolute;
  top: 0;
  bottom: 0;
  width: 40%;
  left: -50%;
  background: linear-gradient(
    120deg,
    rgba(255, 255, 255, 0) 0%,
    rgba(255, 255, 255, 0.35) 50%,
    rgba(255, 255, 255, 0) 100%
  );
  animation: arz-shimmer 1.8s linear infinite;
}

@keyframes arz-shimmer {
  to {
    transform: translateX(250%);
  }
}


/* ============================================================
   SAC MAGIQUE (Inventaire)
============================================================ */
.bag-wrap{ 
  position: fixed; 
  top: 88px; 
  right: 12px; 
  z-index: 4700; 
}

.bag-icon { width: 48px; height: 48px; cursor: pointer; filter: drop-shadow(0 0 8px rgba(255,214,116,.7)); transition: transform .2s; }
.bag-icon:hover { transform: scale(1.08); }
.bag-badge {
  position: absolute; top:-6px; right:-6px;
  min-width:18px; height:18px; padding:0 4px;
  background: var(--bar-fill); color:#3a2400;
  font-weight:800; font-size:12px; border-radius:999px;
  display:grid; place-items:center; box-shadow:0 2px 8px rgba(0,0,0,.4);
}


.bag-menu{
  position: absolute;
  right: 0;
  top: calc(100% + 8px);   /* ▼ sous l’icône */
  margin-top: 0;

  min-width: 240px;
  color: #fff3cc;
  background: rgba(10,0,20,.82);
  border: 1px solid rgba(255,214,116,.45);
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0,0,0,.45);
  backdrop-filter: blur(6px);
  padding: .8rem 1rem;

  max-height: 60vh;
  overflow: hidden;

  display: none;           /* ← caché par défaut */
}


/* Visible + layout flex + zone scrollable */
.bag-menu.show{
  display: flex;
  flex-direction: column;
  animation: slideDown .25s ease-out; /* tu as déjà @keyframes slideDown */
}
@keyframes slideDown { from{opacity:0;transform:translateY(-6px)} to{opacity:1;transform:none} }

.bag-menu h3 {
  margin:.2rem 0 .6rem; text-align:center;
  font-family:"Cinzel Decorative", serif; font-size:1.05rem; color:#ffd674;
}
.bag-menu ul { 
   list-style:none;
   margin:0; 
   padding:0; 
   display:flex; 
   flex-direction:column; 
   gap:.6rem; 
   flex: 1;
  overflow-y: auto;          /* active le scroll vertical */
  max-height: 45vh;          /* sécurité si jamais la structure change */
  padding-right: .4rem;      /* évite que le scroll colle au bord */
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  scrollbar-gutter: stable both-edges;
}

/* Personnalisation de la barre de défilement (Chrome, Edge) */
.bag-menu ul::-webkit-scrollbar {
  width: 8px;
}
.bag-menu ul::-webkit-scrollbar-track {
  background: rgba(255,255,255,.05);
  border-radius: 999px;
}
.bag-menu ul::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg,#ffe9af,#f2c94c);
  border-radius: 999px;
  box-shadow: 0 0 6px rgba(0,0,0,.25);
}


/* Firefox */
.bag-menu ul{
  scrollbar-width: thin;
  scrollbar-color: #f2c94c rgba(255,255,255,.05);
}
 
.bag-menu li {
  display:flex; align-items:center; justify-content:space-between; gap:.6rem;
  background: rgba(255,255,255,.06); border-radius:10px; padding:.45rem .6rem;
}
.bag-item { display:flex; align-items:center; gap:.55rem; }
.bag-item img { width:32px; height:32px; display:block; }
.bag-label { line-height:1.2 }
.bag-name { font-weight:700; }
.bag-menu .bag-empty { margin-top:.3rem; text-align:center; opacity:.75; font-style: italic; }
.bag-menu .bag-use {
  background: var(--bar-fill); color:#3a2400; font-weight:800;
  border:none; border-radius:8px; padding:.25rem .6rem; cursor:pointer;
  box-shadow:0 2px 8px rgba(0,0,0,.35);
}
.bag-menu .bag-use:hover { transform: scale(1.05); }

.bag-used {
  color:#6fff91; font-weight:700;
  text-shadow:0 0 6px rgba(111,255,145,.7);
  background:rgba(0,40,0,.28);
  border-radius:8px; padding:.28rem .55rem;
  display:inline-block; font-size:.9rem;
  box-shadow:0 0 6px rgba(111,255,145,.25);
}

/* Bouton pilule "Mode tranquille" */
.bag-menu .bag-toggle{
  display: inline-flex;
  align-items: center;
  gap: .5rem;
  font-weight: 700;
  font-size: .95rem;
  background: rgba(255,255,255,.06);
  color: #fff3cc;
  border: 1px solid rgba(255,214,116,.35);
  border-radius: 999px;
  padding: .4rem .8rem;
  cursor: pointer;
  transition: transform .15s ease, box-shadow .2s ease, background .2s ease, color .2s ease;
}
.bag-menu .bag-toggle::before{
  content: '';
  filter: drop-shadow(0 0 6px rgba(255,214,116,.4));
}
.bag-menu .bag-toggle:hover{
  transform: translateY(-1px);
  box-shadow: 0 6px 16px rgba(0,0,0,.35);
}
.bag-menu .bag-toggle.on{
  background: linear-gradient(145deg, #ffe9af, #f2c94c);
  color: #3a2400;
  border-color: rgba(255,214,116,.6);
  text-shadow: none;
}

/* =========================
   NOTIFICATION (TOAST) — centre robuste mobile
   ========================= */
.arz-toast{
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  z-index: 9999;
  opacity: 0;
  transition: opacity .35s ease;
  pointer-events: none; /* ne bloque pas l’UI derrière */
}

.arz-toast.show{ opacity: 1; }

.arz-toast .bubble{
  max-width: min(92vw, 560px);
  text-align: center;

  /* Rendu propre et lisible */
  font-family: "Cinzel Decorative", serif; /* ou laisse Georgia si tu préfères */
  font-size: 1rem;
  line-height: 1.45;
  text-shadow: none;          /* ← neutralise le text-shadow du body */
  letter-spacing: .2px;

  /* Cadre + fond */
  background: rgba(10, 0, 20, 0.85);
  color: #fff8e6;
  border: 1px solid rgba(255,214,116,.55);
  border-radius: 14px;
  padding: .9rem 1.1rem;
  box-shadow: 0 18px 40px rgba(0,0,0,.45), 0 0 22px rgba(255,214,116,.25);

  pointer-events: auto; /* utile si un jour tu ajoutes un bouton */
  animation: arz-pulse 2s ease-in-out infinite;
}

@keyframes arz-pulse{
  0%   { box-shadow: 0 18px 40px rgba(0,0,0,.45), 0 0 12px rgba(255,214,116,.25); }
  50%  { box-shadow: 0 18px 40px rgba(0,0,0,.45), 0 0 28px rgba(255,214,116,.8); }
  100% { box-shadow: 0 18px 40px rgba(0,0,0,.45), 0 0 12px rgba(255,214,116,.25); }
}


/* ============================================================
   OVERLAY BLOQUANT
============================================================ */
.lock-overlay {
  position: fixed; inset: 0; z-index: 5000;
  display: none; place-items: center;
  background: var(--overlay);
  backdrop-filter: blur(3px);
  animation: fadein .5s ease;
}
@keyframes fadein { from{opacity:0} to{opacity:1} }
.lock-card {
  width: min(680px, 92vw);
  background: var(--glass);
  border: 1px solid var(--bar-border);
  border-radius: 18px;
  padding: 1.1rem 1.25rem 1.25rem;
  box-shadow: 0 18px 40px rgba(0,0,0,.5);
  backdrop-filter: blur(8px);
  text-align: center;
  animation: rise .8s ease-out;
}
@keyframes rise { from{transform:translateY(20px);opacity:0} to{transform:none;opacity:1} }
.lock-title {
  font-family:"Cinzel Decorative", serif;
  font-size: clamp(22px, 3.2vw, 32px);
  margin: .4rem 0;
  color: #ffd674;
  text-shadow: 0 0 10px rgba(255,214,116,.6);
}
.lock-desc { opacity:.9; line-height:1.5; margin:.5rem auto .8rem; }

/* ============================================================
   RESPONSIVE (mobile)
============================================================ */
@media (max-width: 768px){
  :root{
    --energyY: 100px;  /* descend jauge + sac */
    --bagShift: 5px;   /* petit décalage du sac seul */
  }

  .energy-wrap {
    top: calc(var(--energyY) + env(safe-area-inset-top, 0px));
    left: 50%;
    right: auto;
    transform: translateX(-50%) scale(.95);
    gap: .4rem;
  }

  .energy-bar { width: 60px; }
  .energy-pct { min-width: 2ch; font-size: .85rem; }

   @media (min-width: 769px){
  .bag-wrap{
    position: fixed !important;
    top: var(--hud-top);
    right: var(--bag-right);
    left: auto;
    transform: none !important;
  }

  .energy-wrap{
    position: fixed !important;
    top: var(--hud-top);
    /* jauge = sac + gap → se place à gauche du sac */
    right: calc(var(--bag-right) + var(--bag-size) + var(--hud-gap));
    left: auto;
    transform: none !important;
  }
}
  .bag-wrap {
    top: calc(var(--energyY) + env(safe-area-inset-top, 0px) + var(--bagShift));
    right: 12px;
    left: auto;
  }

  .bag-icon { width: 44px; height: 44px; }

  .quest-ribbon{
    top: calc(var(--energyY) + env(safe-area-inset-top, 0px) + 44px);
    left: 12px; right: 12px;
    transform: none;
  }

  .image-zone { margin-top: 96px !important; }
}


/* ============================================================
   FIX — Positionner la jauge à gauche du sac (desktop)
============================================================ */
/* ============================================================
   RESPONSIVE (mobile) — Titre + HUD sticky
============================================================ */
@media (max-width: 768px){

  /* Le header (titre + HUD) reste collé en haut au scroll */
  .header-box{
    position: sticky;
    top: 0;
    z-index: 5000;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: .5rem;
    padding: .5rem .75rem .6rem;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(6px);
    border-bottom: 1px solid rgba(255,214,116,.25);
  }

  .header-box .page-title{
    margin: 0;
    padding: .2rem 0 .1rem;
    font-size: 1.35rem;
    line-height: 1.2;
    text-align: center;
    color: var(--text);
  }

  /* Le HUD aligné sous le titre, centré */
  .hud-mobile{
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 12px;
    width: 100%;
  }

  /* On neutralise les positions fixes de la jauge et du sac dans le header */
  .hud-mobile .energy-wrap,
  .hud-mobile .bag-wrap{
    position: static !important;
    top: auto !important;
    right: auto !important;
    left: auto !important;
    transform: none !important;
    z-index: auto !important;
  }

  /* Taille/espacement plus compacts sur mobile */
  .hud-mobile .energy-wrap{
    gap: .45rem;
    padding: .5rem .6rem;
  }
  .energy-bar { width: 60px; }
  .energy-pct { min-width: 2ch; font-size: .85rem; }
  .hud-mobile .bag-icon{ width: 44px; height: 44px; }

  /* Le ruban d’alerte s’aligne sous le header */
  .quest-ribbon{
    position: sticky;
    top: calc(56px + 46px); /* ~ hauteur titre + HUD, ajuste si besoin */
    z-index: 4900;
    left: 12px; right: 12px;
    transform: none;
  }

  /* Un petit espace sous le header pour respirer */
  .container{ 
    padding-top: .5rem;
  }

  /* L’image ne doit pas se cacher sous le header sticky */
  .image-zone{ 
    margin-top: .5rem !important; 
  }
}


/* ============================================================
   Desktop : jauge à gauche du sac, fixés
============================================================ */
@media (min-width: 769px){
  :root {
    --hud-top: 84px;
    --bag-right: 12px;
    --bag-size: 48px;
    --hud-gap: 12px;
  }
  .bag-wrap{
    position: fixed !important;
    top: var(--hud-top);
    right: var(--bag-right);
    left: auto;
    transform: none !important;
    z-index: 4700;
  }
  .energy-wrap{
    position: fixed !important;
    top: var(--hud-top);
    right: calc(var(--bag-right) + var(--bag-size) + var(--hud-gap));
    left: auto;
    transform: none !important;
    z-index: 4600;
  }
}
